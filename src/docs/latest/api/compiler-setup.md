---
title: Compiler Setup
nav:
-	index.md
---

# Setting up your compiler

Setting up Kipper is a rather straight-forward process. The compiler can be either be configured using code (in case
you're using the [web bundle](../quickstart.html#setting-up-kipper-for-the-browser) or an
[imported node module](../quickstart.html#importing-kipper-as-a-module)) or using console flags which are passed
to the CLI that is provided by the `@kipper/cli` package.

Depending on which method you're using, you will have to configure the compiler differently although both will have
almost the exact same possibilities and feature-sets. For both methods the API docs will provide in-depth info
about the behaviour and provided functionality of the compiler.

<div class="important">
<p>
The API docs are a work-in-progress and will be slowly, but surely realised with the development of Kipper. As such this
page is for now used as a substitute for the in-detail CLI and Module API docs.
</p>
</div>

## Kipper API

Kipper provides an API for interacting with its compiler, which can be used to configure and inspect the
compilation of a program. This API is per default shipped with the `@kipper/core` package and the
`kipper-standalone.js` file, as well is provided using flags with the CLI (`@kipper/cli`).

For more info view the following sections of this page:
- [Configuring the Kipper Compiler in Node.js](#configuring-the-kipper-compiler-in-nodejs)
- [Configuring the Kipper Compiler CLI](#configuring-the-kipper-compiler-cli)

## Configuring the Kipper Compiler in Node.js

Configuring `KipperCompile.compile()` can be done using the `CompileConfig` interface, which defines all available
parameters for a compilation.

### Kipper Compiler Parameters

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type<br /></th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>fileName</td>
      <td>string</td>
      <td>
        The name of the file. Per default
        <code>anonymous-script</code>.
      </td>
    </tr>
    <tr>
      <td>target</td>
      <td>KipperTarget</td>
      <td>
        The Kipper target instance, which defines the translation behaviour of the Kipper AST
        nodes.
      </td>
    </tr>
    <tr>
      <td>optimisationOptions</td>
      <td>OptimisationOptions</td>
      <td>
        <p>The options for optimising the Kipper output.</p>
        <p>Defaults to an object with the following values:</p>
        <ul class="bullet-list">
          <li><code>optimiseInternals: true</code></li>
          <li><code>optimiseBuiltIns: false</code></li>
        </ul>
        <p>
          More info down below in
          <a href="#kipper-optimiser-parameters">Kipper Optimiser Parameters</a>.
        </p>
      </td>
    </tr>
    <tr>
      <td>extendBuiltIns</td>
      <td>Array&lt;BuiltInFunction&gt;</td>
      <td>
        Additional built-in functions that should be available in the Kipper program. This
        extends builtIns and is per default empty.<br />
      </td>
    </tr>
    <tr>
      <td>builtIns<br /></td>
      <td>Array&lt;BuiltInFunction&gt;</td>
      <td>
        Standard built-in functions that should be available in the Kipper program.
        <br /><br />If this is defined with new built-in functions that Kipper does not
        implement per default, the Kipper target class will have to be updated as well to
        implement the generation of these built-ins. <br /><br />Defaults to the function as
        listed in <a href="../built-in-functions.html">Built-in Functions</a>.<br />
      </td>
    </tr>
  </tbody>
</table>

### Kipper Optimiser Parameters

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>optimiseInternals</td>
      <td>boolean</td>
      <td>
        If set to true, the internal functions (functions generated by the Kipper compiler to
        provide specific functionality) of the compiled code will be optimised using
        tree-shaking reducing the size of the output. Defaults to <code>true</code>.
      </td>
    </tr>
    <tr>
      <td>optimiseBuiltIns</td>
      <td>boolean</td>
      <td>
        If set to true, the
        <a href="../built-in-functions.html">built-in functions</a>
        of the compiled code will be optimised using tree-shaking reducing the size of the
        output. Defaults to <code>false</code>.
      </td>
    </tr>
  </tbody>
</table>

### Example Configuration

```ts
import { KipperCompiler } from "@kipper/core";
import { JSTarget } from "@kipper/target-js";

const compiler = new KipperCompiler();
const result = compiler.compile(
	kipperCode, // A string or a KipperParseStream containing the source code
	{
		fileName: "myProgram.kip",
		target: new JSTarget(),
		optimisationOptions: {
			optimiseInternals: true, // Removes any unused internal function
			optimiseBuiltIns: true, // Removes any unused built-in function
		},
	},
);
```

## Configuring the Kipper Compiler CLI

Parameters for the Kipper Compiler CLI in the console.

<table>
<thead>
  <tr>
    <th>Flags</th>
    <th>Description</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td>-b, --[no-]optimise-builtins</td>
    <td>Optimise the generated built-in functions using tree-shaking to reduce the size of the output.</td>
  </tr>
  <tr>
    <td>-e, --encoding=encoding</td>
    <td>[default: utf8] The encoding that should be used to read the file (ascii,utf8,utf16le).</td>
  </tr>
  <tr>
    <td>-i, --[no-]optimise-internals</td>
    <td>Optimise the generated internal functions using tree-shaking to reduce the size of the output.</td>
  </tr>
  <tr>
    <td>-o, --output-dir=output-dir</td>
    <td>[default: build] The build directory where the compiled files should be placed. If the path does not exist, it will be created.</td>
  </tr>
  <tr>
    <td>-s, --string-code=string-code</td>
    <td>The content of a Kipper file that can be passed as a replacement for the 'file' parameter.</td>
  </tr>
  <tr>
    <td>-t, --target=js|ts</td>
    <td>[default: js] The target language where the compiled program should be emitted to.</td>
  </tr>
  <tr>
    <td>-w, --[no-]warnings</td>
    <td>Show warnings that were emitted during the compilation.</td>
  </tr>
  <tr>
    <td>--[no-]abort-on-first-error</td>
    <td>Abort on the first error the compiler encounters. Same behaviour as '--no-recover'.</td>
  </tr>
  <tr>
    <td>--[no-]log-timestamp</td>
    <td>Show the timestamp of each log message.</td>
  </tr>
  <tr>
    <td>--[no-]recover</td>
    <td>Recover from compiler errors and display all detected compiler errors.</td>
  </tr>
</tbody>
</table>

### Example CLI Command

- Simple compilation of a single file (will generate `./build/sample.js`):
```bash
kipper compile sample.kip
```
- Simple compilation from a string (will generate `./build/anonymous-script.js`):
```bash
kipper compile -s 'print("Hello world!");' 
```
- Generating a UTF16-encoded program, where both internals and built-in are optimised (will generate `./build/anonymous-script.js`):
```bash
kipper compile -s 'print("Hello world!");' -e utf16le -i -b
```
