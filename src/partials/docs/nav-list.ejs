<%# Get all the parents of this dir/file and see if the currently rendering elements need to be visible or not %>
<% const getParentList = (item) => {
  return item && "parent" in item && item.parent ? [item.parent, ...getParentList(item.parent)] : [];
} %>
<% const parentNavDirs = getParentList(thisNavTreeItem); %>
<% const selectedFileInDir = parentNavDirs.find(e => e === sidebarNav); %>
<ul class="
    docs-sidebar-nav-list
    no-style-list
    flex-column
    <%= selectedFileInDir ? "selected-sidebar-nav-dir" : "" %>
">
    <% sidebarNav.items.forEach((fileOrDir) => { %>
        <%# The current file is selected if the current filename (where the ejs file is included) matches the name in 'file.path' %>
        <% const pathParts = fileOrDir.path.split("/"); %>
        <% const isDir = "items" in fileOrDir; %>
        <% if (!isDir) { %>
            <% const isCurrentFile = pathParts[pathParts.length - 1] === filename; %>
            <li>
                <p class="sidebar-nav-header-list-item <%= isCurrentFile ? "selected-page-sidebar-nav-header" : "" %>">
                    <%# The file path is an absolute format, like for example: '/.../.../*.html' %>
                    <a href="<%= rootDir %><%= fileOrDir.path %>"><%= fileOrDir.title %></a>
                </p>
            </li>
        <% } else { %>
            <li>
                <p class="
                    sidebar-nav-header-list-item
                    <%= selectedFileInDir || fileOrDir.path === filename ? "selected-page-sidebar-nav-header" : "" %>
                    sidebar-nav-header-dir-item
                ">
                    <button>
                        <i class="fa-solid fa-xs fa-caret-down"></i> <%= fileOrDir.title %>
                    </button>
                </p>
                <%- include('./nav-list', {
                    sidebarNav: fileOrDir,
                    header: false,
                    title: title,
                    description: description,
                    thisFile: thisFile,
                    docsRoot: docsRoot,
                    inRootDir: false,
                }) %>
            </li>
        <% } %>
    <% }); %>
</ul>
